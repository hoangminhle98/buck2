"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[359],{69491:(e,i,n)=>{n.r(i),n.d(i,{assets:()=>a,contentTitle:()=>c,default:()=>h,frontMatter:()=>s,metadata:()=>r,toc:()=>l});var o=n(74848),t=n(28453);const s={id:"isolation_dir",title:"Isolation dir"},c=void 0,r={id:"concepts/isolation_dir",title:"Isolation dir",description:'Every buck2 daemon has an "isolation directory" which acts as an isolation',source:"@site/../docs/concepts/isolation_dir.md",sourceDirName:"concepts",slug:"/concepts/isolation_dir",permalink:"/docs/concepts/isolation_dir",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{id:"isolation_dir",title:"Isolation dir"},sidebar:"main",previous:{title:"Daemon (buckd)",permalink:"/docs/concepts/daemon"},next:{title:".buckconfig",permalink:"/docs/concepts/buckconfig"}},a={},l=[{value:"Isolation dir uses",id:"isolation-dir-uses",level:2},{value:"How to set the isolation dir for a command",id:"how-to-set-the-isolation-dir-for-a-command",level:2},{value:"Isolation dir buck-out path",id:"isolation-dir-buck-out-path",level:2}];function d(e){const i={a:"a",code:"code",em:"em",h2:"h2",p:"p",pre:"pre",strong:"strong",...(0,t.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(i.p,{children:["Every ",(0,o.jsx)(i.code,{children:"buck2"}),' daemon has an "isolation directory" which acts as an isolation\nmechanism. This enables the ability to have multiple independent daemons, each\nwith a different isolation dir.']}),"\n",(0,o.jsxs)(i.p,{children:["Different daemons enable the concurrent execution of commands, as a ",(0,o.jsx)(i.strong,{children:"single\ndaemon can generally execute only a single command at a time"}),". Most buck2\ncommands only act in their own specified isolation dir. For example,\n",(0,o.jsx)(i.code,{children:"buck2 kill"})," will only kill the daemon associated to the default isolation-dir\n(",(0,o.jsx)(i.code,{children:"v2"}),"). Exceptions to this rule include ",(0,o.jsx)(i.code,{children:"buck2 killall"})," command, which will kill\nall buck2 processes on the machine."]}),"\n",(0,o.jsxs)(i.p,{children:["WARNING: Isolation dirs have a very important consequence: ",(0,o.jsx)(i.code,{children:"buck2"})," invocations\nwith ",(0,o.jsx)(i.em,{children:"different"})," isolation dirs ",(0,o.jsxs)(i.strong,{children:["never share ",(0,o.jsx)(i.em,{children:"any"})," cached artifacts"]}),"."]}),"\n",(0,o.jsx)(i.h2,{id:"isolation-dir-uses",children:"Isolation dir uses"}),"\n",(0,o.jsx)(i.p,{children:"Isolation dirs are also relied on for developer environment tooling (e.g. LSPs)\nthat have to run in the background without affecting the users manually\ntriggered builds."}),"\n",(0,o.jsxs)(i.p,{children:["Also isolation dirs are used to allow for\n",(0,o.jsx)(i.a,{href:"/docs/users/faq/common_issues#are-multiple-concurrent-commands-supported",children:"recursive invocations"}),"."]}),"\n",(0,o.jsx)(i.h2,{id:"how-to-set-the-isolation-dir-for-a-command",children:"How to set the isolation dir for a command"}),"\n",(0,o.jsxs)(i.p,{children:["The default isolation dir is ",(0,o.jsx)(i.code,{children:"v2"}),". Thus any ",(0,o.jsx)(i.code,{children:"buck2"})," command without an explicit\nisolation dir is equivalent to"]}),"\n",(0,o.jsx)(i.pre,{children:(0,o.jsx)(i.code,{className:"language-sh",children:"$ buck2 --isolation-dir v2 $ARGS\n"})}),"\n",(0,o.jsxs)(i.p,{children:["The isolation dir can also be set via the ",(0,o.jsx)(i.code,{children:"BUCK_ISOLATION_DIR"})," env var."]}),"\n",(0,o.jsxs)(i.p,{children:["NOTE: ",(0,o.jsx)(i.code,{children:"--isolation-dir"})," arg must ",(0,o.jsx)(i.em,{children:"always"})," appear immediately after ",(0,o.jsx)(i.code,{children:"buck2"}),". For\nexample, ",(0,o.jsx)(i.code,{children:"buck2 build --isolation-dir v2 $ARGS"})," is an invalid command."]}),"\n",(0,o.jsx)(i.h2,{id:"isolation-dir-buck-out-path",children:"Isolation dir buck-out path"}),"\n",(0,o.jsxs)(i.p,{children:["The isolation dir specifies the root directory in ",(0,o.jsx)(i.a,{href:"/docs/concepts/buck_out",children:(0,o.jsx)(i.code,{children:"buck-out"})}),"\nwhich will be used to isolate a daemon. With the default ",(0,o.jsx)(i.code,{children:"v2"})," isolation dir,\n",(0,o.jsx)(i.code,{children:"buck2"})," will be using the ",(0,o.jsx)(i.code,{children:"$PROJECT_ROOT/buck-out/v2"})," directory for all target\noutputs and internal metadata. ",(0,o.jsx)(i.code,{children:"$PROJECT_ROOT"})," refers to the directory where the\n",(0,o.jsx)(i.a,{href:"/docs/concepts/glossary#project",children:"project"})," lives."]})]})}function h(e={}){const{wrapper:i}={...(0,t.R)(),...e.components};return i?(0,o.jsx)(i,{...e,children:(0,o.jsx)(d,{...e})}):d(e)}},28453:(e,i,n)=>{n.d(i,{R:()=>c,x:()=>r});var o=n(96540);const t={},s=o.createContext(t);function c(e){const i=o.useContext(s);return o.useMemo((function(){return"function"==typeof e?e(i):{...i,...e}}),[i,e])}function r(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:c(e.components),o.createElement(s.Provider,{value:i},e.children)}}}]);